<div class="space-y-8 py-8 px-4 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="max-w-7xl mx-auto">
    <h1 class="text-4xl font-bold text-gray-900">Dashboard</h1>
    <p class="text-gray-600 mt-2">Resumen de tu actividad financiera</p>
  </div>

  <!-- Error Message -->
  @if (error()) {
    <div class="max-w-7xl mx-auto">
      <div class="bg-red-50 border border-red-200 rounded-lg p-4">
        <p class="text-red-600">{{ error() }}</p>
      </div>
    </div>
  }

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="max-w-7xl mx-auto">
      <div class="text-center py-12">
        <div class="inline-block">
          <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
        </div>
        <p class="text-gray-600 mt-4">Cargando datos...</p>
      </div>
    </div>
  }

  <!-- Main Content -->
  @if (!isLoading() && !error()) {
    <div class="max-w-7xl mx-auto">
      <!-- Key Metrics Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <!-- Total Income Card -->
        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-shadow">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-gray-600 text-sm font-medium">Ingresos Totales</p>
              <p class="text-3xl font-bold text-green-600 mt-2">
                ${{ dashboardData().analysis.total_income.toFixed(2) }}
              </p>
            </div>
            <span class="material-icons text-green-600 text-4xl opacity-20">trending_up</span>
          </div>
        </div>

        <!-- Total Expense Card -->
        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-shadow">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-gray-600 text-sm font-medium">Gastos Totales</p>
              <p class="text-3xl font-bold text-red-600 mt-2">
                ${{ dashboardData().analysis.total_expense.toFixed(2) }}
              </p>
            </div>
            <span class="material-icons text-red-600 text-4xl opacity-20">trending_down</span>
          </div>
        </div>

        <!-- Net Gain Card -->
        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-shadow">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-gray-600 text-sm font-medium">Balance Neto</p>
              <p class="text-3xl font-bold" [ngClass]="dashboardData().analysis.net_gain >= 0 ? 'text-blue-600' : 'text-red-600'" mt-2>
                ${{ dashboardData().analysis.net_gain.toFixed(2) }}
              </p>
            </div>
            <span class="material-icons text-blue-600 text-4xl opacity-20">account_balance</span>
          </div>
        </div>

        <!-- Unspent Percentage Card -->
        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-shadow">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-gray-600 text-sm font-medium">% No Gastado</p>
              <p class="text-3xl font-bold text-purple-600 mt-2">
                {{ dashboardData().analysis.unspent_percentage.toFixed(1) }}%
              </p>
            </div>
            <span class="material-icons text-purple-600 text-4xl opacity-20">savings</span>
          </div>
        </div>
      </div>

      <!-- Secondary Metrics Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        <!-- Avg Monthly Income -->
        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-shadow">
          <p class="text-gray-600 text-sm font-medium">Promedio Mensual de Ingresos</p>
          <p class="text-2xl font-bold text-green-600 mt-3">
            ${{ dashboardData().analysis.avg_monthly_income.toFixed(2) }}
          </p>
        </div>

        <!-- Avg Monthly Expense -->
        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-shadow">
          <p class="text-gray-600 text-sm font-medium">Promedio Mensual de Gastos</p>
          <p class="text-2xl font-bold text-red-600 mt-3">
            ${{ dashboardData().analysis.avg_monthly_expense.toFixed(2) }}
          </p>
        </div>

        <!-- Comparison with Last Period -->
        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-shadow">
          <p class="text-gray-600 text-sm font-medium">Comparación Período Anterior</p>
          <p class="text-2xl font-bold mt-3" [ngClass]="dashboardData().analysis.expense_comparison.includes('aumentó') ? 'text-red-600' : 'text-green-600'">
            {{ dashboardData().analysis.expense_comparison }}
          </p>
        </div>
      </div>

      <!-- Predictions and Insights -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <!-- Prediction Card -->
        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-shadow">
          <h3 class="text-lg font-semibold text-gray-900 mb-4">Gasto Predicho</h3>
          <p class="text-gray-600 text-sm mb-3">Según tu historial, es probable que gastes:</p>
          <p class="text-3xl font-bold text-orange-600">
            ${{ dashboardData().prediction.toFixed(2) }}
          </p>
          <p class="text-gray-600 text-xs mt-4">Esta es una predicción basada en tus datos históricos</p>
        </div>

        <!-- Top Category -->
        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-shadow">
          <h3 class="text-lg font-semibold text-gray-900 mb-4">Categoría Principal</h3>
          <p class="text-gray-600 text-sm mb-3">Tus gastos se concentran en:</p>
          <p class="text-3xl font-bold text-indigo-600">
            {{ dashboardData().analysis.top_category }}
          </p>
          <p class="text-gray-600 text-xs mt-4">Considera optimizar esta categoría</p>
        </div>
      </div>

      <!-- Top Days Section -->
      @if (dashboardData().analysis.top_days && dashboardData().analysis.top_days.length > 0) {
        <div class="bg-white rounded-xl shadow-md p-6 border border-gray-100">
          <h3 class="text-lg font-semibold text-gray-900 mb-4">Días de Mayor Actividad</h3>
          <div class="flex flex-wrap gap-3">
            @for (day of dashboardData().analysis.top_days; track day) {
              <span class="inline-block bg-blue-50 border border-blue-200 rounded-full px-4 py-2 text-sm text-blue-700 font-medium">
                {{ day }}
              </span>
            }
          </div>
        </div>
      }
    </div>
  }
</div>
